<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ArmDriverUnit: Todo List</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ArmDriverUnit
   </div>
   <div id="projectbrief">Firmware which controls a 6-dof robot arm</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('todo.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Todo List </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="reflist">
<dt><a class="anchor" id="_todo000006"></a>Member <a class="el" href="ArmDriverUnit_8ino_ae349ccd7f7ee58d0c655f9ad330e6b1a.html#ae349ccd7f7ee58d0c655f9ad330e6b1a">homeArmMotors</a>  (void)</dt>
<dd>print homing debug just for motors which are homing  </dd>
<dt><a class="anchor" id="_todo000004"></a>Member <a class="el" href="ArmDriverUnit_8ino_a110d5b83b937b614c8acce5fbd0d0cc2.html#a110d5b83b937b614c8acce5fbd0d0cc2">initSpeedParams</a>  (void)</dt>
<dd>stepper doesn't have speed the way servos and dcs do?????? this is because stepper calculates speed using durations, but this means openLoopGain and openLoopSpeed mean nothing for it???  </dd>
<dt><a class="anchor" id="_todo000003"></a>Member <a class="el" href="ArmDriverUnit_8ino_afe461d27b9c48d5921c00d521181f12f.html#afe461d27b9c48d5921c00d521181f12f">loop</a>  ()</dt>
<dd><p class="startdd">There should be a check so that if the motor is moving away from the goal position or has been moving for a while without reaching the expected angle, it stops... like a timeout. </p>
<p>What happens if a new command tells the motor to turn in opposite direction? Abrupt changes are bad. </p>
<p>If the stepper is trying to turn but hasn't gotten anywhere, there should be a check in the microcontroller that there's an issue (there can also be a check in the gui) </p>
<p>Check to see if any global variables can be turned into static variables inside <a class="el" href="ArmDriverUnit_8ino_afe461d27b9c48d5921c00d521181f12f.html#afe461d27b9c48d5921c00d521181f12f" title="Main code which loops forever. Parses commands, prints motor angles and blinks the builtin LED...">loop()</a> </p>
<p class="enddd">I noticed that sending a new move command while motors are moving messes with open loop calculations?  </p>
</dd>
<dt><a class="anchor" id="_todo000011"></a>Member <a class="el" href="PinSetup_8h_adf7fab7635b7d1bbf4e12db45ade26b5.html#adf7fab7635b7d1bbf4e12db45ade26b5">M1_GEAR_RATIO</a>  </dt>
<dd>fix this based on gear reduction inside and outside motor  </dd>
<dt><a class="anchor" id="_todo000013"></a>Member <a class="el" href="PinSetup_8h_aea73ec8384e5d37e1ea1d4f354b8b7a4.html#aea73ec8384e5d37e1ea1d4f354b8b7a4">M1_MAX_HARD_ANGLE</a>  </dt>
<dd>work this out maybe with max or dharik  </dd>
<dt><a class="anchor" id="_todo000012"></a>Member <a class="el" href="PinSetup_8h_abc51b6b3787c6d1c03f522086e3d1f4d.html#abc51b6b3787c6d1c03f522086e3d1f4d">M1_MIN_HARD_ANGLE</a>  </dt>
<dd>work this out maybe with max or dharik  </dd>
<dt><a class="anchor" id="_todo000010"></a>Member <a class="el" href="PinSetup_8h_a993707090a7306c5a4445645e6fc9e62.html#a993707090a7306c5a4445645e6fc9e62">MIN_JOINT_ANGLE</a>  </dt>
<dd>I forget if I fixed this, but these angle limits need to be ignored for the wrist that rotates as it shouldn't have limits  </dd>
<dt><a class="anchor" id="_todo000007"></a>Class <a class="el" href="classParser.html">Parser</a>  </dt>
<dd>Clean up parsing code to make it easier to read and reduce repetition.  </dd>
<dt><a class="anchor" id="_todo000008"></a>Class <a class="el" href="classPidController.html">PidController</a>  </dt>
<dd>Can I deal with the fact that angleTolerance is a <a class="el" href="classPidController.html" title="This is intended to be a generic PID controller class. ">PidController</a> attribute and not a <a class="el" href="classRobotMotor.html" title="The base class for ServoMotor, StepperMotor and DcMotor. ">RobotMotor</a> attribute?  </dd>
<dt><a class="anchor" id="_todo000009"></a>Member <a class="el" href="classPidController_a345e065af2a6d2c8a9c9d9f758b1382f.html#a345e065af2a6d2c8a9c9d9f758b1382f">PidController::setOutputLimits</a>  (float minVal, float maxVal)</dt>
<dd>should setOutputLimits be restricted to just pidcontroller or should it be something for all motors...? but then i set openloopspeed to 50 in the <a class="el" href="ArmDriverUnit_8ino_a4fc01d736fe50cf5b977f755b675f11d.html#a4fc01d736fe50cf5b977f755b675f11d" title="Teensy setup. Calls many init functions to prep comms and motors. ">setup()</a>???? i need to rethink the velocity vs speed vs direction stuff!  </dd>
<dt><a class="anchor" id="_todo000014"></a>Member <a class="el" href="PinSetup_8h_a924fbe483fd8c13808cad6ab252d4cb0.html#a924fbe483fd8c13808cad6ab252d4cb0">pinSetup</a>  (void)</dt>
<dd><p class="startdd">Perhaps pinsetup.h &amp; pinsetup.cpp should be changed to motorsetup or just setup as it's also got angle limits and gear ratios </p>
<p class="enddd">If I think about it, physically there's the motor and the joint, so the motor params (internal reduction, encoder resolution) could be separate from the joint params (external reduction, angle limits)  </p>
</dd>
<dt><a class="anchor" id="_todo000005"></a>Member <a class="el" href="ArmDriverUnit_8ino_afe447f63d60d2f605cc708afdac3cdd4.html#afe447f63d60d2f605cc708afdac3cdd4">respondToLimitSwitches</a>  (void)</dt>
<dd>put code here to check if the motor should be at the end of its path but isn't? well how would it know if it isn't if it doesn't hit the limit switch because of software limits?  </dd>
<dt><a class="anchor" id="_todo000015"></a>Class <a class="el" href="classRobotMotor.html">RobotMotor</a>  </dt>
<dd><p class="startdd">Make joint objects instead of motor objects and have switches etc inside of them? </p>
<p>Perhaps the initialization of motor angle parameters should be its own function </p>
<p>Perhaps the initialization of the motor's pins should also be its own function </p>
<p class="enddd">Perhaps the constructor should take a series of structs, one for each type  </p>
</dd>
<dt><a class="anchor" id="_todo000016"></a>Member <a class="el" href="classRobotMotor_a5041cb13c1b4edfe5ded33b1f56688ac.html#a5041cb13c1b4edfe5ded33b1f56688ac">RobotMotor::setDesiredAngle</a>  (float angle)</dt>
<dd>try to make everything go through this by putting conditions based on movement mode?  </dd>
<dt><a class="anchor" id="_todo000017"></a>Member <a class="el" href="classRobotMotor_a7f7419cf6d15ef0116c4028ee4e69cf5.html#a7f7419cf6d15ef0116c4028ee4e69cf5">RobotMotor::setSoftwareAngle</a>  (float angle)</dt>
<dd>needs to be tested to make sure that a call to calcCurrentAngle will return the same thing as getCurrentAngle  </dd>
<dt><a class="anchor" id="_todo000001"></a>Member <a class="el" href="ArmDriverUnit_8ino_a4fc01d736fe50cf5b977f755b675f11d.html#a4fc01d736fe50cf5b977f755b675f11d">setup</a>  ()</dt>
<dd><p class="startdd">Implement error checking, clean up code, comment code, make sure ISR variables are volatile </p>
<p>Make sure the math calculations are written correctly and calculate as quickly as possible. Floating point math doesn't seem bad, but at worst, convert float to int before motor control and do int math inside interrupts. </p>
<p>(Nick) Finish implementing/integrating heartbeat and watchdog interrupt </p>
<p>Figure out where to disable interrupts so that I don't read a value while it's being modified </p>
<p>Determine the actual clockwise and counter-clockwise directions of motors based on their wiring in the arm itself </p>
<p>Issue: interrupt functions must be defined outside of classes... </p>
<p>Confirm all the pins will work with interrupts and not stepping on each other. Do I send 3.3v to all interrupt pins simultaneously to test thing? </p>
<p>Deal with overflow of encoderCount.. does it ever reach max value? </p>
<p>What do I do for angles over 360? Do I keep counting up? Do I keep count of how many rotations I've done? </p>
<p>Different types of ramping profiles - trapezoid vs quintic polynomial? Ramping of stepper should be linear, higher level ramping should occur in gui. The base station/odroid should be in charge of ramping up angles and the teensy should just go to them? Perhaps if a large angle is requested there should still be a way to stop it though. </p>
<p>Determine whether it's worth it to use the built in quadrature decoders. Quadrature on ftm1,2: pins 3/4,29/30: cant use for pwm anymore. Quadrature on tpm1,2: pins 16/17, (tpm2 not implemented in teensy?). </p>
<p class="enddd">setJointAngleTolerance in here might need to be adjusted when gear ratio is adjusted!!! check other dependencies too!!! </p>
</dd>
</dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
