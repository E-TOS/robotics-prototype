<!doctype html>
<html lang="en">

<head>
    <!-- Required meta and other tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>SC Robotics GUI - Arm</title>
    <link rel="shortcut icon" href="static/img/sclogo_header_black.ico">

    <!-- Bootstrap CSS -->
    <link href="../static/css/bootstrap-4.1.2.min.css" rel="stylesheet">
    <link href="../static/css/font-awesome-4.7.0.min.css" rel="stylesheet">
    <link href="../static/css/titatoggle-dist.css" rel="stylesheet">
    <link href="../static/css/arm.css" rel="stylesheet">
    <script src="../static/js/jquery-3.3.1.min.js"></script>
    <script src="../static/js/helpers.js"></script>

    <!-- for roslibjs stuff -->
    <script type="text/javascript" src="../static/js/roslibjs/roslib.min.js"></script>
    <script type="text/javascript" src="../static/js/roslibjs/eventemitter2.min.js"></script>
    <!-- all for ros3d -->
    <script type="text/javascript" src="../static/js/roslibjs/three.js"></script>
    <script type="text/javascript" src="../static/js/roslibjs/ColladaLoader.js"></script>
    <script type="text/javascript" src="../static/js/roslibjs/ColladaLoader2.min.js"></script>
    <script type="text/javascript" src="../static/js/roslibjs/STLLoader.js"></script>
    <script type="text/javascript" src="../static/js/roslibjs/ros3d.min.js"></script>
    <!-- homemade -->
    <script type="text/javascript" src="../static/js/roslibjs/ros-helpers.js"></script>
    <script src="../static/js/app.js"></script>
    <script src="../static/js/arm.js"></script>
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <!-- <script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous" async></script> -->
    <script src="../static/js/popper-1.14.3.min.js"></script>
    <script src="../static/js/bootstrap-4.1.2.min.js"></script>
</head>

<body>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top" style="margin-bottom: 120px">
      <div class="col-md-1">
          <a class="navbar-brand" href="'javascript:void(0)'">
              <img src="../static/img/sclogo_header.png">
          </a>
      </div>

      <div class="dropdown col-md-2">
        <button id="mux" type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
          Device Channel
        </button>
        <div class="dropdown-menu">
          <a id="mux-0" class="dropdown-item">0: Rover</a>
          <a id="mux-1" class="dropdown-item">1: Arm</a>
          <a id="mux-2" class="dropdown-item">2: Science</a>
          <a id="mux-3" class="dropdown-item">3: PDS</a>
        </div>
      </div>

      <div class="dropdown col-md-2">
        <button id="serial-type" type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
          Serial Type
        </button>
        <div class="dropdown-menu">
          <a id="uart" class="dropdown-item">uart</a>
          <a id="usb" class="dropdown-item">usb</a>
        </div>
      </div>

      <!-- <div class="col-md-6">
        <input type="text" id="serial-cmd-input">
      </div>
      <div class="col-md-1">
        <button type="button" id="send-serial-btn" class="btn btn-primary">Send serial cmd</button>
      </div> -->

      <div class="col-md-7">
        <div class="row" style="color:white">
          <div class="col-md-3">BATTERY VOLTAGE: </div>
          <div class="col-md-1" id="battery-voltage">-</div>
        </div>
      </div>
    </nav>
    <br>
    <br>
    <div style="margin-bottom:10px"></div>

    <div class="container fill">
      <div>
        <div class="row" > <!-- arm sim, camera stream -->
          <div class="col-md-6" align="center"> <!-- Arm simulation -->
            <h5 class="container-header">Arm Postion</h5>
            <img src="../static/images/robotic-arm.jpg" class="mx-auto d-block" id="arm-position"/>
          </div>
          <div class="col-md-6" align="center"> <!-- Camera stream -->
            <h5 class="container-header">Arm Vision</h5>
            <!-- It would be preferable to use video tag, but mjpeg streams are not have no general support beyond img tags -->
            <img id="camera-feed" src="http://{{ roverIP }}:8090/?action=stream" class="mx-auto d-block" alt="Arm Camera Stream Offline" onerror="this.onerror=null;this.src='../static/images/stream-offline.jpg';"/>
          </div>
        </div>

        <div class="row"> <!-- console, motor conrols, motor table -->
          <!-- log console -->
          <div class="col-md-3" align="center">
            <h5 class="container-header">Log Console</h5>
            <div class="form-group">
              <textarea id="write-to-log" rows="8" readonly></textarea>
              <p hidden id="last-odroid-rx"></p>
              <br>
              <!--log console buttons-->
              <div class="btn-group" role="group" id="logs-btn">
                <a id="click_btn">
                  <button type="button" class="btn btn-secondary">Open Logs</button>
                </a>
                <a id="clear-log">
                  <button type="button" class="btn btn-secondary" onclick="clearLogConsole()">Clear Logs</button>
                </a>
                <a id="test-log">
                  <button type="button" class="btn btn-secondary" onclick="appendToConsole('Simple test.');">Test</button>
                </a>
              </div>
              <div class="btn-group" role="group">
                <button type="button" id="ping-odroid" class="btn btn-primary" aria-hidden="true">Ping Odroid</button>
                <button type="button" id="ping-arm-mcu" class="btn btn-primary" aria-hidden="true">Ping Arm MCU</button>
              </div>
            </div>
          </div>
          <!-- control panel -->
          <div class="col-md">
            <h5 class="container-header">Control Panel</h5>
            <div class="row control-main-btn">
              <div class="row control-main-toggles">
                <div class="row">
                  <div class="col-sm" align="center" style="border-style:none;">
                      <span>
                          <strong>Command Listener</strong>
                      </span>
                      <div class="form-check checkbox-slider--a checkbox-slider-lg" align="center">
                          <label>
                              <input id="toggle-arm-listener-btn" type="checkbox">
                              <span> </span>
                          </label>
                      </div>
                  </div>
                  <div class="col-sm" align="center" style="border-style:none;">
                      <span>
                          <strong>Manual Control</strong>
                      </span>
                      <div class="form-check checkbox-slider--a checkbox-slider-lg" align="center">
                          <label>
                              <input id="manual-control-btn" type="checkbox" onchange="manualControl()">
                              <span> </span>
                          </label>
                      </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm" align="center" style="border-style:none;">
                      <span>
                          <strong>Arm Stream</strong>
                      </span>
                      <div class="form-check checkbox-slider--a checkbox-slider-lg" align="center">
                          <label>
                              <input id="toggle-arm-stream-btn" type="checkbox">
                              <span> </span>
                          </label>
                      </div>
                  </div>
                  <div class="col-sm" align="center" style="vertical-align:middle; border-style:none">
                      <button type="button" id="homing-button" class="btn btn-primary btn-lg fa fa-home fa-lg" aria-hidden="true" style="padding: 16px 10px 16px 10px;margin-top:12px">
                          <span style="font-family:'Helvetica Neue', Arial, sans-serif;"> Home</span>
                      </button>
                  </div>
                  <div class="col-sm" align="center" style="vertical-align:middle; border-style:none">
                      <button type="button" id="reboot-button" class="btn btn-primary btn-lg fa fa-retweet fa-lg" aria-hidden="true" style="padding: 16px 10px 16px 10px;margin-top:12px">
                          <span style="font-family:'Helvetica Neue', Arial, sans-serif;"> Reboot MCU</span>
                      </button>
                  </div>
                </div>
              </div>
              <div class="row movement-buttons">
                <!-- Automatic controls section -->
                <table class="table-grp" style="display: block" id="ArmcontrolsOFF" align="center">
                  <tr> <!-- first row -->
                    <td></td>
                    <td valign="bottom">
                      <a href="javascript:void(0)" id="click_btn_pitch_up">
                        <button type="button" class="control-btn">
                          <strong>Pitch<br>Up</strong>
                        </button>
                      </a>
                    </td>
                    <td></td>
                    <td style="width:30px"></td>
                    <td></td>
                    <td>
                      <a href="javascript:void(0)" id="click_btn_arm_up">
                        <button type="button" class="control-btn">
                          <strong>Arm<br>Up</strong>
                        </button>
                      </a>
                    </td>
                    <td></td>
                  </tr>
                  <tr> <!-- second row -->
                    <td>
                      <a href="javascript:void(0)" id="click_btn_roll_left">
                        <button type="button" class="control-btn">
                          <strong>Roll<br>Left</strong>
                        </button>
                      </a>
                    </td>
                    <td>
                      <a href="javascript:void(0)" id="click_btn_pitch_down">
                        <button type="button" class="control-btn">
                          <strong>Pitch<br>Down</strong>
                        </button>
                      </a>
                    </td>
                    <td>
                      <a href="javascript:void(0)" id="click_btn_roll_right">
                        <button type="button" class="control-btn">
                          <strong>Roll<br>Right</strong>
                        </button>
                      </a>
                    </td>
                    <td></td>
                    <td>
                      <a href="javascript:void(0)" id="click_btn_arm_left">
                        <button type="button" class="control-btn">
                          <strong>Arm<br>Left</strong>
                        </button>
                      </a>
                    </td>
                    <td>
                      <a href="javascript:void(0)" id="click_btn_arm_down">
                        <button type="button" class="control-btn">
                          <strong>Arm<br>Down</strong>
                        </button>
                      </a>
                    </td>
                    <td>
                      <a href="javascript:void(0)" id="click_btn_arm_right">
                        <button type="button" class="control-btn">
                          <strong>Arm<br>Right</strong>
                        </button>
                      </a>
                    </td>
                  </tr>
                  <tr> <!-- third row -->
                    <td>
                      <a href="javascript:void(0)" id="click_btn_claw_open">
                        <button type="button" class="control-btn" style="margin-bottom:6px">
                          <strong>Claw<br>Open</strong>
                        </button>
                      </a>
                    </td>
                    <td></td>
                    <td>
                      <a href="javascript:void(0)" id="click_btn_claw_close">
                        <button type="button" class="control-btn" style="margin-bottom:6px">
                          <strong>Claw<br>Close</strong>
                        </button>
                      </a>
                    </td>
                    <td></td>
                    <td>
                      <a href="javascript:void(0)" id="click_btn_arm_back">
                        <button type="button" class="control-btn" style="margin-bottom:6px">
                          <strong>Arm<br>Back</strong>
                        </button>
                      </a>
                    </td>
                    <td></td>
                    <td>
                      <a href="javascript:void(0)" id="click_btn_arm_forward">
                        <button type="button" class="control-btn" style="margin-bottom:6px">
                          <strong>Arm<br>Fwd</strong>
                        </button>
                      </a>
                    </td>
                  </tr>
                  <tr> <!-- labels -->
                      <th colspan="3">
                        <strong>CLAW CONTROLS</strong>
                      </th>
                      <th style="width:30px; background:#990000; border:0px solid #990000"></th>
                      <th colspan="3">
                        <strong>ARM CONTROLS</strong>
                      </th>
                    </tr>
                </table>
                <!-- Manual controls section -->
                <table class="table-grp2" style="display: none;" id="ArmcontrolsON" align="center">
                    <tr>
                      <!-- motor 3 -->
                        <td>
                            <a href="javascript:void(0)" id="click_btn_motor3_ccw">
                                <button type="button" class="control-btn2 control-btn-up fa fa-chevron-up fa-3x"></button>
                            </a>
                        </td>
                        <td>
                            <button type="button" class="control-btn-mid" disabled>
                                <strong>M3 Elbow up/down</strong>
                            </button>
                        </td>
                        <td>
                            <a href="javascript:void(0)" id="click_btn_motor3_cw">
                                <button type="button" class="control-btn2 control-btn-down fa fa-chevron-down fa-3x"></button>
                            </a>
                        </td>

                        <td style="width:30px"></td>

                        <!-- motor 4 -->
                        <td>
                            <a href="javascript:void(0)" id="click_btn_motor4_ccw">
                                <button type="button" class="control-btn2 control-btn-up fa fa-chevron-up fa-3x"></button>
                            </a>
                        </td>
                        <td>
                            <button type="button" class="control-btn-mid" disabled>
                                <strong>M4 Wrist up/down</strong>
                            </button>
                        </td>
                        <td>
                            <a href="javascript:void(0)" id="click_btn_motor4_cw">
                                <button type="button" class="control-btn2 control-btn-down fa fa-chevron-down fa-3x"></button>
                            </a>
                        </td>
                    </tr>
                    <tr>
                      <!-- motor 2 -->
                      <td>
                          <a href="javascript:void(0)" id="click_btn_motor2_ccw">
                              <button type="button" class="control-btn2 control-btn-up fa fa-chevron-up fa-3x"></button>
                          </a>
                      </td>
                      <td>
                          <button type="button" class="control-btn-mid" disabled>
                              <strong>M2 Shoulder up/down</strong>
                          </button>
                      </td>
                      <td>
                          <a href="javascript:void(0)" id="click_btn_motor2_cw">
                              <button type="button" class="control-btn2 control-btn-down fa fa-chevron-down fa-3x"></button>
                          </a>
                      </td>

                        <td></td>

                        <!-- motor 5 -->
                        <td>
                            <a href="javascript:void(0)" id="click_btn_motor5_ccw">
                                <button type="button" class="control-btn2 control-btn-left fa fa-rotate-left fa-3x"></button>
                            </a>
                        </td>
                        <td>
                            <button type="button" class="control-btn-mid" disabled>
                                <strong>M5 Wrist Screw out/in</strong>
                            </button>
                        </td>
                        <td>
                            <a href="javascript:void(0)" id="click_btn_motor5_cw">
                                <button type="button" class="control-btn2 control-btn-right fa fa-rotate-right fa-3x"></button>
                            </a>
                        </td>

                    </tr>
                    <tr>
                      <!-- motor 1 -->
                      <td>
                          <a href="javascript:void(0)" id="click_btn_motor1_ccw">
                              <button type="button" class="control-btn2 control-btn-left fa fa-rotate-left fa-3x"></button>
                          </a>
                      </td>
                      <td>
                          <button type="button" class="control-btn-mid" disabled>
                              <strong>M1 Shoulder left/right</strong>
                          </button>
                      </td>
                      <td>
                          <a href="javascript:void(0)" id="click_btn_motor1_cw">
                              <button type="button" class="control-btn2 control-btn-right fa fa-rotate-right fa-3x"></button>
                          </a>
                      </td>

                        <td></td>

                        <!-- motor 6 -->
                        <td>
                            <a href="javascript:void(0)" id="click_btn_motor6_ccw">
                                <button type="button" class="control-btn2 control-btn-left fa fa-expand fa-3x"></button>
                            </a>
                        </td>
                        <td>
                            <button type="button" class="control-btn-mid" disabled>
                                <strong>M6 Gripper open/close</strong>
                            </button>
                        </td>
                        <td>
                            <a href="javascript:void(0)" id="click_btn_motor6_cw">
                                <button type="button" class="control-btn2 control-btn-right fa fa-compress fa-3x"></button>
                            </a>
                        </td>
                    </tr>
                    <tr> <!-- labels -->
                      <th colspan="7" style="background:#990000; border:0px solid #990000">
                        <strong>CLAW CONTROLS</strong>
                      </th>
                    </tr>
                </table>
              </div>
              <div class="row closed-loop-toggles"> <!-- closed loop toggles -->
                <!-- m1 closed loop -->
                <div class="col-sm-3" align="center" style="border-style:none;">
                  <span>
                    <strong>M1 PID</strong>
                  </span>
                  <div class="form-check checkbox-slider--a checkbox-slider-lg" align="center">
                    <label>
                      <input id="m1-closed-loop-btn" type="checkbox">
                      <span></span>
                    </label>
                  </div>
                </div>
                <!-- m2 closed loop -->
                <div class="col-sm-3" align="center" style="border-style:none;">
                  <span>
                    <strong>M2 PID</strong>
                  </span>
                  <div class="form-check checkbox-slider--a checkbox-slider-lg" align="center">
                    <label>
                      <input id="m2-closed-loop-btn" type="checkbox">
                      <span></span>
                    </label>
                  </div>
                </div>
               <!-- m3closed loop -->
                <div class="col-sm-3" align="center" style="border-style:none;">
                  <span>
                    <strong>M3 PID</strong>
                  </span>
                  <div class="form-check checkbox-slider--a checkbox-slider-lg" align="center">
                    <label>
                      <input id="m3-closed-loop-btn" type="checkbox">
                      <span></span>
                    </label>
                  </div>
                </div>
                <!-- m4 closed loop -->
                <div class="col-sm-3" align="center" style="border-style:none;">
                  <span>
                    <strong>M4 PID</strong>
                  </span>
                  <div class="form-check checkbox-slider--a checkbox-slider-lg" align="center">
                    <label>
                      <input id="m4-closed-loop-btn" type="checkbox">
                      <span></span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- motor table and extras -->
          <div class="col-md-4" align="center">
            <div class="row"> <!-- motor table -->
              <h5 class="container-header">Motor Table</h5>
              <table class="table table-sm table-bordered" id="motor-table" style="font-size:12px; background:#FDD3DF; text-align: left">
                <thead class="thead-dark">
                  <tr>
                    <th scope="col">Motor</br>(Number)</th>
                    <th scope="col">Status</br>(Alive/Dead)</th>
                    <th scope="col">Position</br>(Degrees)</th>
                    <th scope="col">Current</br>(A)</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">M1 (Shoulder Swivel)</th>
                    <!-- @TODO: add backend code to update status/motor current-->
                    <td id="m1-status">N/A</td>
                    <td id="m1-angle">-</td>
                    <td id="m1-current">N/A</td>
                  </tr>
                  <tr>
                    <th scope="row">M2 (Shoulder Flex)</th>
                    <td id="m2-status">N/A</td>
                    <td id="m2-angle">-</td>
                    <td id="m2-current">N/A</td>
                  </tr>
                  <tr>
                    <th scope="row">M3 (Elbow Flex)</th>
                    <td id="m3-status">N/A</td>
                    <td id="m3-angle">-</td>
                    <td id="m3-current">N/A</td>
                  </tr>
                  <tr>
                    <th scope="row">M4 (Wrist Flex)</th>
                    <td id="m4-status">N/A</td>
                    <td id="m4-angle">-</td>
                    <td id="m4-current">N/A</td>
                  </tr>
                  <tr>
                    <th scope="row">M5 (Wrist Twist)</th>
                    <td id="m5-status">N/A</td>
                    <td id="m5-angle">-</td>
                    <td id="m5-current">N/A</td>
                  </tr>
                  <tr>
                    <th>M6 (Gripper)</th>
                    <td id="m6-status">N/A</td>
                    <td id="m6-angle">-</td>
                    <td id="m6-current">N/A</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="row" align="center"> <!-- extra controls -->
              <table>
                <tr>
                  <th colspan="2">
                  </th>
                  <th style="width:30px; background:#990000; border:0px solid #990000">
                    <strong>EXTRA CONTROLS</strong>
                  </th>
                </tr>
                <tr>
                  <td>
                    <button title="Stop all motors" id="stop-all-motors" type="button" class="control-btn-mid" disabled>
                      <strong>STOP<br>(Q)</strong>
                    </button>
                  </td>
                  <td>
                    <button title="Reset memorized angle values" id="reset-motor-angles" type="button" class="control-btn-mid" disabled>
                      <strong>Reset angles<br>(O)</strong>
                    </button>
                  </td>
                  <td>
                    <button title="List all commands" id="list-all-cmds" type="button" class="control-btn-mid" disabled>
                      <strong>List cmds<br>(L)</strong>
                    </button>
                  </td>
                  <td>
                    <input type="text" id="arm-speed-multiplier-input" value="1" size="3">
                  </td>
                  <td>
                    <button type="button" id="arm-speed-multiplier-btn" class="btn btn-primary">Send speed<br>multiplier</button>
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

</body>

</html>
